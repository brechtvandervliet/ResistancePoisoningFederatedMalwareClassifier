import numpy as np
from lim_code.model_train.safew import safew_base_predictions


def save_data(baseline_model, base_models, data):
    """
    This method dumps some data to numpy files for use in notebooks.
    """

    def save(name, X, y=None):
        if y is not None:
            np.save("data/{}_y_true.npy".format(name), y)
        baseline_pred, candidate_pred = safew_base_predictions(
            baseline_model=baseline_model,
            base_models=base_models,
            X=X,
        )
        np.save("data/{}_baseline_pred.npy".format(name), baseline_pred)
        np.save("data/{}_candidate_pred.npy".format(name), candidate_pred)

    save(name="cloud", X=data.cloud_X_test, y=data.cloud_y_test)
    save(name="client", X=data.X_preinstalled, y=data.y_preinstalled)
    save(name="popular_malicious", X=data.client_X_test_popular_malicious)
    save(name="popular_clean", X=data.client_X_test_popular_clean)
    save(name="sorted", X=data.client_X_test_sorted, y=data.client_y_test_sorted)